# goReport 技术选型决策文档

> **版本**：v1.0
> **日期**：2026-02-03
> **状态**：待确认

---

## 目录

1. [后端技术选型](#1-后端技术选型)
   - 1.1 [Web框架对比](#11-web框架对比)
   - 1.2 [ORM框架对比](#12-orm框架对比)
   - 1.3 [数据库对比](#13-数据库对比)
   - 1.4 [缓存方案对比](#14-缓存方案对比)
   - 1.5 [JWT认证对比](#15-jwt认证对比)
2. [前端技术选型](#2-前端技术选型)
   - 2.1 [画布技术对比](#21-画布技术对比)
   - 2.2 [编辑器对比](#22-编辑器对比)
   - 2.3 [状态管理对比](#23-状态管理对比)
   - 2.4 [构建工具对比](#24-构建工具对比)
3. [基础设施选型](#3-基础设施选型)
   - 3.1 [容器化方案对比](#31-容器化方案对比)
   - 3.2 [反向代理对比](#32-反向代理对比)

---

## 1. 后端技术选型

### 1.1 Web框架对比

#### 候选方案

| 框架 | 性能(Benchmark) | 功能特性 | 社区活跃度 | 学习曲线 | 维护成本 |
|------|----------------|----------|-----------|----------|----------|
| **Gin** | ★★★★★ (最高) | 路由、中间件、参数绑定、验证、JSON | ★★★★★ (50k+ stars) | 中等 | 低 |
| **标准库 net/http** | ★★★★ (良好) | 基础HTTP服务 | ★★★★★ (官方) | 低 | 中 |
| **Echo** | ★★★★★ (最高) | 类似Gin，更灵活 | ★★★★ (28k+ stars) | 中等 | 低 |
| **Fiber** | ★★★★★ (最高) | Express风格，极快 | ★★★★ (30k+ stars) | 低 | 低 |
| **Chi** | ★★★★ (良好) | 轻量、兼容标准库 | ★★★ (14k+ stars) | 低 | 低 |

#### 详细对比

**Gin**

优点：
- ✅ 性能极优（基于httprouter，Radix Tree路由匹配）
- ✅ 功能完整（路由分组、中间件链、参数绑定、验证）
- ✅ 生态丰富（JWT、CORS、RateLimit等中间件）
- ✅ 文档完善，社区活跃
- ✅ 自动JSON序列化/反序列化
- ✅ 内置Recovery中间件（防止panic崩溃）
- ✅ 支持HTTP/2
- ✅ 大量生产环境验证

缺点：
- ❌ 依赖较多（但都是常用库）
- ❌ 灵活性略低于标准库（但够用）
- ❌ 代码量稍大（比标准库多约20%抽象）

适用场景：
- RESTful API服务
- 需要快速开发
- 需要中间件生态
- 生产环境高并发

**标准库 net/http**

优点：
- ✅ 零依赖
- ✅ 学习曲线最低
- ✅ 完全控制HTTP处理流程
- ✅ 与标准库无缝集成
- ✅ 长期维护（Go官方）

缺点：
- ❌ 缺少路由参数提取（需手写）
- ❌ 缺少中间件链支持（需手动包装Handler）
- ❌ 缺少参数绑定（需手动解析JSON/Query）
- ❌ 缺少验证框架
- ❌ 样板代码多（每个Handler需手动处理错误、响应）
- ❌ 路由匹配性能较差（线性扫描）

适用场景：
- 极简微服务
- 学习/教学项目
- 对依赖敏感的项目

**Echo**

优点：
- ✅ 性能与Gin相当
- ✅ 更灵活的设计（可替换Router）
- ✅ 自定义Validator支持
- ✅ 支持多种数据绑定方式
- ✅ 中间件生态丰富

缺点：
- ❌ 社区比Gin稍小
- ❌ 文档略少于Gin

适用场景：
- 需要极高灵活性的项目
- 复杂的企业级应用

**Fiber**

优点：
- ✅ 基于fasthttp，性能极优
- ✅ Express.js风格API，上手快
- ✅ 内存占用低
- ✅ 内置WebSocket支持
- ✅ 零内存分配（Zero Allocation）

缺点：
- ❌ 不兼容net/http（测试较麻烦）
- ❌ 生态略小于Gin
- ❌ 某些中间件需适配

适用场景：
- 极高性能要求
- 内存敏感场景
- Express开发者迁移

#### 决策建议

| 场景 | 推荐方案 | 理由 |
|------|----------|------|
| **通用/生产** | **Gin** | 功能完整、性能优秀、生态丰富、文档完善 |
| **极简/教学** | 标准库 | 零依赖，学习Go基础 |
| **极高性能** | Fiber | 基于fasthttp，内存优化更好 |
| **灵活性优先** | Echo | 可替换组件，高度可定制 |

**本项目推荐：Gin**

理由：
1. goReport需要大量RESTful API（报表CRUD、数据源管理、仪表盘等）
2. 需要中间件链（JWT认证 -> CORS -> 日志 -> 业务Handler）
3. 需要参数绑定和验证（JSON请求体、Query参数、Path参数）
4. 团队熟悉度高（国内Go社区Gin最流行）
5. 生产环境验证充分

---

### 1.2 ORM框架对比

#### 候选方案

| 框架 | 性能 | 功能 | 学习曲线 | 类型安全 | 维护成本 |
|------|------|------|----------|----------|----------|
| **GORM** | ★★★ (中等) | 完整CRUD、关联、迁移、钩子等 | 中等 | 是 | 中 |
| **sqlx** | ★★★★ (良好) | SQL查询增强、结构体扫描 | 低 | 部分 | 低 |
| **Bun** | ★★★★ (良好) | 类似GORM但更简洁 | 中等 | 是 | 低 |
| **原生SQL** | ★★★★★ (最高) | 完全控制SQL | 高 | 否 | 高 |
| **Ent** | ★★★ (中等) | Facebook开发，类型安全 | 高 | 强 | 中 |

#### 详细对比

**GORM**

优点：
- ✅ 功能最完整（CRUD、关联、预加载、钩子、迁移）
- ✅ 支持多种数据库（MySQL、PostgreSQL、SQLite、SQL Server）
- ✅ 链式API设计，代码可读性好
- ✅ 自动迁移（AutoMigrate）
- ✅ 插件生态丰富（分库分表、审计日志）
- ✅ 社区最大，文档最全
- ✅ 支持软删除

缺点：
- ❌ 性能中等（有反射开销）
- ❌ 复杂查询时SQL控制不够精细
- ❌ 学习曲线较陡（功能多）
- ❌ 默认开启日志（生产环境需关闭）

适用场景：
- 通用CRUD应用
- 多数据库支持需求
- 快速开发
- 需要关联查询

**sqlx**

优点：
- ✅ 轻量级（只在database/sql基础上增强）
- ✅ 性能接近原生
- ✅ 支持命名参数查询
- ✅ 结构体自动扫描
- ✅ 学习曲线低

缺点：
- ❌ 不是完整ORM（缺少关联、迁移等）
- ❌ 需手写SQL
- ❌ 缺少钩子等高级功能

适用场景：
- 性能敏感场景
- 复杂SQL查询为主
- 对ORM不信任的团队

**Bun**

优点：
- ✅ 现代设计（取代go-pg）
- ✅ 性能优于GORM
- ✅ 支持Hook和关联
- ✅ 更好的PostgreSQL支持

缺点：
- ❌ 社区比GORM小
- ❌ 功能略少于GORM
- ❌ 主要是PostgreSQL生态

**原生SQL (database/sql)**

优点：
- ✅ 性能最高
- ✅ 完全控制SQL
- ✅ 零依赖（标准库）
- ✅ 最灵活

缺点：
- ❌ 样板代码极多
- ❌ 手动处理结果集扫描
- ❌ 无类型安全（运行时错误）
- ❌ 维护成本高

适用场景：
- 极高性能要求
- 复杂SQL优化
- 遗留系统迁移

#### 决策建议

| 场景 | 推荐方案 | 理由 |
|------|----------|------|
| **通用/快速开发** | **GORM** | 功能完整，开发效率高 |
| **性能敏感/SQL复杂** | sqlx | 轻量，SQL可控 |
| **PostgreSQL优先** | Bun | 现代设计，性能好 |
| **遗留系统** | 原生SQL | 完全控制 |

**本项目推荐：GORM**

理由：
1. goReport有大量实体（Report、Datasource、Dashboard、Cell等）
2. 需要关联查询（Report -> Datasource -> Tables）
3. 需要软删除（报表删除后保留数据）
4. 需要自动迁移（开发迭代快）
5. 国内Go开发者最熟悉

---

### 1.3 数据库对比

#### 候选方案

| 数据库 | 性能 | 扩展性 | 生态 | 运维复杂度 | 成本 |
|--------|------|--------|------|-----------|------|
| **MySQL 8.0** | ★★★★ | ★★★★ | ★★★★★ | 中等 | 免费/商业 |
| **PostgreSQL 15** | ★★★★★ | ★★★★★ | ★★★★★ | 中等 | 免费 |
| **SQLite** | ★★★ | ★★ | ★★★ | 极低 | 免费 |
| **TiDB** | ★★★★ | ★★★★★ | ★★★ | 高 | 免费/商业 |
| **SQL Server** | ★★★★ | ★★★★ | ★★★★ | 高 | 商业 |

#### 决策建议

**本项目推荐：MySQL 8.0**

理由：
1. 原Java版本使用MySQL，兼容性最好
2. 国内MySQL生态最成熟
3. 报表系统通常读多写少，MySQL足够
4. 团队熟悉度高
5. 云厂商支持好（阿里云RDS、AWS RDS）

---

### 1.4 缓存方案对比

#### 候选方案

| 方案 | 性能 | 复杂度 | 一致性 | 适用场景 |
|------|------|--------|--------|----------|
| **Redis** | ★★★★★ | 中 | 最终一致 | 会话、缓存、排行榜 |
| **本地缓存** | ★★★★ | 低 | 强一致（单机） | 配置、元数据 |
| **无缓存** | ★★ | 极低 | 强一致 | 极简应用 |
| **Redis Cluster** | ★★★★★ | 高 | 最终一致 | 大规模分布式 |

#### 详细对比

**Redis（单实例）**

优点：
- ✅ 性能极高（10万+ QPS）
- ✅ 数据结构丰富（String、Hash、List、Set、ZSet）
- ✅ 支持过期时间（TTL）
- ✅ 持久化选项（RDB、AOF）
- ✅ 发布订阅（可用于实时通知）
- ✅ 原子操作（INCR、Lua脚本）

缺点：
- ❌ 需要额外部署
- ❌ 单点故障（需哨兵或Cluster）
- ❌ 内存成本（数据量大时）
- ❌ 缓存一致性问题

适用场景：
- 会话存储
- 数据源连接缓存
- 查询结果缓存
- 报表导出任务状态

**本地缓存（如bigcache、ristretto）**

优点：
- ✅ 零网络开销（内存访问）
- ✅ 无需外部依赖
- ✅ 简单部署

缺点：
- ❌ 多实例不一致
- ❌ 重启丢失
- ❌ 单机内存限制

适用场景：
- 配置缓存
- 元数据缓存
- 读多写少的静态数据

**无缓存**

优点：
- ✅ 架构最简单
- ✅ 数据一致性最好
- ✅ 无需维护缓存逻辑

缺点：
- ❌ 性能依赖数据库
- ❌ 无法应对高并发读

适用场景：
- 低并发应用
- MVP阶段
- 数据实时性要求极高

#### 决策建议

**本项目推荐：Redis（开发阶段可选，生产必需）**

理由：
1. 数据源连接需要缓存（避免频繁创建连接）
2. 报表查询结果可缓存（报表数据通常不变）
3. 导出任务状态需要Redis（异步任务跟踪）
4. 会话管理需要Redis（JWT Token 黑名单）

**开发环境建议：**
- Docker Compose一键部署 Redis
- 本地开发可关闭缓存（配置开关）

---

### 1.5 JWT认证对比

#### 候选方案

| 库 | 标准兼容 | 性能 | 功能 | 维护状态 |
|----|----------|------|------|----------|
| **golang-jwt/jwt** | ★★★★★ | ★★★★★ | 完整 | 活跃（推荐） |
| **dgrijalva/jwt-go** | ★★★★ | ★★★★ | 完整 | 停止维护（有安全漏洞） |
| **casbin** | ★★★ | ★★★ | RBAC+ | 活跃 |

#### 决策建议

**本项目推荐：golang-jwt/jwt v5**

理由：
- 最新版本（v5），API设计更好
- 支持JWT所有标准算法
- 社区最活跃（原jwt-go迁移过来）
- 无安全漏洞
- 与Gin中间件集成良好

---

## 2. 前端技术选型

### 2.1 画布技术对比

这是**最关键的决策之一**，直接影响报表设计器的性能和用户体验。

#### 候选方案

| 技术 | 性能(10k单元格) | 开发难度 | 交互丰富度 | 浏览器兼容 |
|------|----------------|----------|-----------|------------|
| **Canvas 2D API** | ★★★★★ (流畅) | 高 | 中 | 全平台 |
| **DOM + CSS Grid** | ★★★ (卡顿) | 低 | 极高 | 全平台 |
| **SVG** | ★★★ (卡顿) | 中 | 高 | 全平台 |
| **WebGL (Pixi.js)** | ★★★★★ (极流畅) | 极高 | 低 | 现代浏览器 |
| **Canvas + 虚拟滚动** | ★★★★★ (流畅) | 高 | 中 | 全平台 |

#### 详细对比

**Canvas 2D API**

优点：
- ✅ 性能最高（直接GPU渲染，无DOM开销）
- ✅ 内存效率高（不创建DOM节点）
- ✅ 完全控制渲染流程
- ✅ 适合大量单元格（10万+也能流畅）
- ✅ 跨平台（Web、Electron、移动端）

缺点：
- ❌ 开发难度高（需手写所有交互逻辑）
- ❌ 文本渲染不如DOM精细（需处理字体、换行）
- ❌ 无障碍支持差（屏幕阅读器无法识别）
- ❌ 调试困难（无法Chrome DevTools直接检查）
- ❌ 需处理高清屏（devicePixelRatio）
- ❌ 打印/PDF导出需额外处理

开发成本：
- 单元格渲染：2-3天
- 选择交互：3-5天
- 滚动优化：2-3天
- 文本编辑：3-5天
- 合并单元格：2-3天
- **总计：约15-20天**

适用场景：
- 企业级报表（数据量大）
- 高性能要求
- 专业报表工具（如Excel Online、Google Sheets）

**DOM + CSS Grid/Flex**

优点：
- ✅ 开发简单（HTML+CSS即可）
- ✅ 交互丰富（原生事件、右键菜单、复制粘贴）
- ✅ 文本渲染完美（浏览器自动处理字体、换行）
- ✅ 无障碍支持好（屏幕阅读器友好）
- ✅ 调试简单（Chrome DevTools直接查看）
- ✅ 打印/PDF导出天然支持
- ✅ 开发速度快（MVP首选）

缺点：
- ❌ 性能差（DOM节点过多时卡顿）
- ❌ 内存占用高（每个单元格一个DOM节点）
- ❌ 大量单元格时（>5000）明显卡顿
- ❌ 滚动性能差（需虚拟滚动优化）

开发成本：
- 基础网格：1天
- 选择交互：1-2天
- 样式编辑：2天
- 合并单元格：2天
- **总计：约5-8天**

适用场景：
- MVP/原型开发
- 简单报表（<1000单元格）
- 快速迭代

**SVG**

优点：
- ✅ 矢量图形（缩放无损）
- ✅ 可交互（DOM事件）
- ✅ 可打印

缺点：
- ❌ 性能比Canvas差
- ❌ 文本渲染不如DOM
- ❌ 复杂布局困难

适用场景：
- 图表渲染（Chart.js使用Canvas，D3使用SVG）
- 简单报表

**WebGL (Pixi.js/Three.js)**

优点：
- ✅ 性能最高（GPU加速）
- ✅ 可处理百万级元素

缺点：
- ❌ 开发难度极高
- ❌ 文本渲染复杂
- ❌ 浏览器兼容性

适用场景：
- 游戏
- 大数据可视化（如地图、3D）

#### 决策建议

| 场景 | 推荐方案 | MVP时间 | 生产时间 |
|------|----------|---------|----------|
| **快速MVP** | DOM + CSS | 5-8天 | 后续重构 |
| **长期产品** | Canvas | 15-20天 | 持续优化 |
| **折中方案** | DOM + 虚拟滚动 | 8-12天 | 可接受 |

**本项目建议：**

**Phase 1（MVP）：DOM + CSS Grid**
- 理由：快速验证产品，降低初期开发成本
- 限制：支持最多 1000 单元格（约 100x10）
- 优化：使用虚拟滚动处理大数据

**Phase 2（优化）：迁移到 Canvas**
- 理由：性能要求提升，支持大数据报表
- 时间：Phase 1 完成后 2-3 周重构
- 参考：Excel Online、Google Sheets 使用 Canvas

#### 推荐：Phase 1 使用 DOM，预留 Canvas 迁移路径

---

### 2.2 编辑器对比

#### 候选方案

| 编辑器 | 功能 | 体积 | 性能 | 学习成本 |
|--------|------|------|------|----------|
| **Monaco Editor** | ★★★★★ (完整IDE) | 大 (~8MB) | ★★★★ | 中等 |
| **CodeMirror 6** | ★★★★ (专业编辑器) | 中 (~1MB) | ★★★★★ | 中等 |
| **Ace Editor** | ★★★★ (功能丰富) | 中 (~500KB) | ★★★ | 低 |
| **textarea + 高亮** | ★★ (基础) | 小 (~10KB) | ★★★★★ | 极低 |

#### 详细对比

**Monaco Editor（VS Code同款）**

优点：
- ✅ 功能最全（语法高亮、自动完成、错误提示、代码折叠）
- ✅ TypeScript/JavaScript 支持极佳
- ✅ 可定制主题
- ✅ 熟悉度高（开发者都用VS Code）

缺点：
- ❌ 体积大（需要 worker、language server）
- ❌ 初始化慢（首次加载需2-3秒）
- ❌ 移动端支持差
- ❌ 内存占用高

适用场景：
- 专业开发环境
- 复杂表达式编辑
- 报表公式编辑（类似Excel公式编辑器）

**CodeMirror 6**

优点：
- ✅ 现代架构（模块化、可扩展）
- ✅ 性能优秀（大文件编辑流畅）
- ✅ 体积小（按需加载）
- ✅ 移动端支持好
- ✅ 无障碍支持好

缺点：
- ❌ 学习曲线比Monaco陡
- ❌ 生态比Monaco小

适用场景：
- 轻量级代码编辑
- 需要移动端支持

**Ace Editor**

优点：
- ✅ 成熟稳定（GitHub使用）
- ✅ 功能丰富
- ✅ 主题多样
- ✅ 学习成本低

缺点：
- ❌ 架构较老（维护放缓）
- ❌ 性能不如CodeMirror 6

#### 决策建议

**本项目推荐：Monaco Editor**

理由：
1. 报表表达式编辑需要完整IDE体验（Excel公式编辑器级别）
2. 用户群体是数据分析人员，熟悉Excel公式
3. 需要语法高亮和错误提示（防止公式错误）
4. 体积可接受（报表设计器不是首页，可异步加载）
5. 与Vue 3集成良好（vue-monaco-editor组件）

**优化策略：**
- 异步加载Monaco（点击"编辑表达式"时才加载）
- 使用CDN加载核心文件（减小打包体积）
- 配置按需加载语言支持（只加载JavaScript/SQL）

---

### 2.3 状态管理对比

#### 候选方案

| 方案 | 复杂度 | 适用场景 | 调试 | 性能 |
|------|--------|----------|------|------|
| **Pinia** | 中 | 中大型应用 | ★★★★★ | ★★★★★ |
| **Vuex 4** | 中 | 历史项目 | ★★★★ | ★★★★ |
| **Vue Reactivity API** | 低 | 小型应用 | ★★★ | ★★★★★ |
| **Provide/Inject** | 低 | 依赖注入 | ★★ | ★★★★ |

#### 决策建议

**本项目推荐：Pinia**

理由：
1. Vue 3 官方推荐（Vuex进入维护模式）
2. TypeScript 支持最好（类型推断完整）
3. 模块化设计（每个Store独立文件）
4. Devtools 支持（时间旅行、状态检查）
5. 学习曲线平缓（类似Vuex但更简单）

---

### 2.4 构建工具对比

#### 候选方案

| 工具 | 启动速度 | 热更新 | 打包速度 | 生态 | 配置复杂度 |
|------|----------|--------|----------|------|-----------|
| **Vite** | ★★★★★ (极快) | ★★★★★ | ★★★★★ | ★★★★ | 低 |
| **Webpack** | ★★ (慢) | ★★★ | ★★ | ★★★★★ | 高 |
| **esbuild** | ★★★★★ | ★★★ | ★★★★★ | ★★ | 中 |
| **Parcel** | ★★★ | ★★★ | ★★★ | ★★★ | 极低 |

#### 决策建议

**本项目推荐：Vite**

理由：
1. Vue 3 官方推荐（Vue CLI迁移到Vite）
2. 启动速度极快（基于esbuild）
3. 热更新极快（HMR < 50ms）
4. 配置简单（vite.config.ts）
5. 插件生态丰富（兼容Rollup插件）

---

## 3. 基础设施选型

### 3.1 容器化方案对比

#### 开发环境：Docker Compose

**推荐方案：3容器部署**

```yaml
# docker-compose.yml
services:
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev
    
  backend:
    build: ./backend
    ports:
      - "8085:8085"
    volumes:
      - ./backend:/app
    environment:
      - DB_DSN=root:root@tcp(mysql:3306)/jimureport?charset=utf8mb4
      - REDIS_ADDR=redis:6379
    depends_on:
      - mysql
      - redis
      
  mysql:
    image: mysql:8.0
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=jimureport
    volumes:
      - mysql-data:/var/lib/mysql
      - ./db/init.sql:/docker-entrypoint-initdb.d/init.sql
      
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data

volumes:
  mysql-data:
  redis-data:
```

**优点：**
- 一键启动完整开发环境：`docker-compose up`
- 环境一致（所有开发者相同环境）
- 无需本地安装MySQL/Redis
- 数据持久化（volume）

**缺点：**
- 需要Docker知识
- 资源占用（内存4GB+）

#### 生产环境：Kubernetes vs Docker Swarm

| 方案 | 复杂度 | 扩展性 | 云厂商支持 |
|------|--------|--------|-----------|
| **Kubernetes** | 高 | ★★★★★ | 全平台 |
| **Docker Swarm** | 中 | ★★★ | 部分 |
| **云厂商托管** | 低 | ★★★★ | 特定平台 |

**推荐：** 初期使用云厂商托管K8s（如阿里云ACK、AWS EKS）

---

### 3.2 反向代理对比

| 方案 | 性能 | 功能 | 配置复杂度 |
|------|------|------|-----------|
| **Nginx** | ★★★★★ | 丰富 | 中 |
| **Traefik** | ★★★★ | 云原生 | 低 |
| **Caddy** | ★★★★ | 自动化HTTPS | 极低 |

**推荐：Nginx（生产）+ Caddy（开发）**

---

## 4. 总结：推荐技术栈

### 后端

| 组件 | 技术 | 版本 | 理由 |
|------|------|------|------|
| 语言 | Go | 1.22+ | 性能、并发 |
| Web框架 | **Gin** | 1.9+ | 功能完整、生态丰富 |
| ORM | **GORM** | 1.25+ | 功能完整、国内主流 |
| 数据库 | **MySQL** | 8.0+ | 兼容性、生态 |
| 缓存 | **Redis** | 7+ | 性能、数据源连接缓存 |
| JWT | golang-jwt/jwt | v5 | 标准、安全 |

### 前端

| 组件 | 技术 | 版本 | 理由 |
|------|------|------|------|
| 框架 | Vue | 3.4+ | 响应式、生态 |
| 语言 | TypeScript | 5.3+ | 类型安全 |
| 构建 | **Vite** | 5.0+ | 极速开发体验 |
| UI库 | Element Plus | 2.5+ | 企业级组件 |
| 状态管理 | **Pinia** | 2.1+ | Vue 3官方 |
| 画布 | **DOM + CSS** (Phase 1) | - | 快速开发 |
| 编辑器 | **Monaco Editor** | - | 完整IDE体验 |
| HTTP | Axios | 1.6+ | 标准、拦截器 |

### 基础设施

| 组件 | 技术 | 理由 |
|------|------|------|
| 容器化 | Docker + Compose | 开发环境一致 |
| 反向代理 | Nginx | 性能、稳定 |
| 监控 | Prometheus + Grafana | 云原生标准 |
| 日志 | ELK / Loki | 集中式日志 |

---

## 5. 待确认决策点

请在以下决策点做出选择：

### 5.1 后端确认

- [ ] **Web框架**：Gin / Echo / Fiber / 标准库
  - **建议**：Gin（功能完整、生态丰富）

- [ ] **ORM**：GORM / sqlx / 原生SQL
  - **建议**：GORM（开发效率高）

- [ ] **缓存**：Redis（必需）/ 可选
  - **建议**：Redis（数据源连接缓存必需）

### 5.2 前端确认

- [ ] **画布技术**：
  - A) DOM + CSS（Phase 1）-> Canvas（Phase 2）
  - B) 直接上Canvas
  - **建议**：A（快速MVP，后续优化）

- [ ] **编辑器**：
  - A) Monaco Editor（完整功能，体积大）
  - B) CodeMirror 6（轻量，功能少）
  - **建议**：A（报表需要完整公式编辑）

### 5.3 部署确认

- [ ] **开发环境**：
  - A) Docker Compose（推荐）
  - B) 本地安装（灵活但环境不一致）
  - **建议**：A

- [ ] **后端目录**：
  - A) 独立 `backend/` 文件夹
  - B) 根目录（当前结构）
  - **建议**：A（清晰分离前后端）

---

## 6. 项目目录结构（建议）

确认技术选型后，建议目录结构：

```
jimureport/
├── backend/                    # Go 后端（独立目录）
│   ├── cmd/server/
│   │   └── main.go
│   ├── internal/
│   │   ├── config/
│   │   ├── auth/
│   │   ├── models/
│   │   ├── repository/
│   │   ├── service/
│   │   └── httpserver/
│   ├── pkg/
│   │   └── database/
│   ├── go.mod
│   ├── go.sum
│   └── Dockerfile
├── frontend/                   # Vue 前端（独立目录）
│   ├── src/
│   ├── public/
│   ├── index.html
│   ├── package.json
│   ├── vite.config.ts
│   └── Dockerfile
├── docker-compose.yml          # 开发环境一键部署
├── docker-compose.prod.yml     # 生产环境配置
├── Makefile                    # 常用命令
├── README.md
└── openspec/                   # 需求规范（保留）
    ├── specs/
    └── changes/
```

---

## 7. 下一步

请确认以上技术选型决策：

1. 阅读对比分析
2. 做出选择（或提出修改）
3. 确认后执行：
   - 创建独立 backend/ 目录
   - 配置 Docker Compose 开发环境
   - 初始化项目

---

**请回复：**
- "确认执行" - 按推荐方案执行
- "修改方案" - 列出需要修改的决策点
- "讨论细节" - 深入讨论某个技术选型
